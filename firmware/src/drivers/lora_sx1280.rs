//! This module interfaces with the SX1280 and SX1281 LoRa protocls, for communicating
//! with ELRS transmitters. (ELRS transmitters send control inputs from the radio controller)

use stm32hal2::{
    gpio::Pin,
    spi::Spi,
    pac::{SPI3},
};

/// See Datasheet, section 13.
#[repr(u8)]
enum Reg {
    RxGain = 0x891,
    ManualGainSetting = 0x895,
    LnaGainValue = 0x89E,
    LnaGainControl = 0x89F,
    SynchPeakAttentuation = 0x8C2,
    PayloadLength = 0x901,
    LoraHeaderMode = 0x903,
    RangingRequestAddressByte3 = 0x912,
    RangingRequestAddressByte2 = 0x913,
    RangingRequestAddressByte1 = 0x914,
    RangingRequestAddressByte0 = 0x915,
    RangingDeviceAddressByte3 = 0x916,
    RangingDeviceAddressByte2 = 0x917,
    RangingDeviceAddressByte1 = 0x918,
    RangingDeviceAddressByte0 = 0x919,
    RangingFilterWindowSize = 0x91E,
    ResetRangingFilter = 0x923,
    RangingResultMux = 0x924,
    SfAdditionalConfiguration = 0x925,
    RangingCalibrationByte2 = 0x92B,
    RangingCalibrationByte1 = 0x92C,
    RangingCalibrationByte0 = 0x92D,
    RangingIdCheckLength = 0x931,
    FrequencyErrorCorrection = 0x93C,
    LoraSynchWord1 = 0x944,
    LoraSynchWord2 = 0x945, // todo: Data sheet lists 955, but that's taken. Typo?
    FeiByte2 = 0x954,
    FeiByte1 = 0x955,
    FeiByte0 = 0x956,
    RangingResultByte2 = 0x961,
    RangingResultByte1 = 0x962,
    RangingResultByte0 = 0x963,
    RangingRssi = 0x964,
    FreezeRangingResult = 0x97F,
    PacketPreambleSettings = 0x9C1,
    WhiteningInitialValue = 0x9C5,
    CrcPolynomialDefinitionMsb = 0x9C6,
    // todo: Lots of duplicate reg adds here in datasheet!!! Making educated guesses.
    CrcPolynomialDefinitionLsb = 0x9C7,
    CrcPolynomialSeedByte2 = 0x9C8,
    CrcPolynomialSeedByte1 = 0x9C9,
    CrcPolynomialSeedByte0 = 0x9CA,
    CrcMsbInitialValue = 0x9CB,
    CrcLsbInitialValue = 0x9CC,
    SynchAddressControl = 0x9CD,
    SyncAddress1Byte4 = 0x9CE,
    SyncAddress1Byte3 = 0x9CF,
    SyncAddress1Byte2 = 0x9D0,
    SyncAddress1Byte1 = 0x9D1,
    SyncAddress1Byte0 = 0x9D2,
    SyncAddress2Byte4 = 0x9D3,
    SyncAddress2Byte3 = 0x9D4,
    SyncAddress2Byte2 = 0x9D5,
    SyncAddress2Byte1 = 0x9D6,
    SyncAddress2Byte0 = 0x9D7,
    SyncAddress3Byte4 = 0x9D8,
    SyncAddress3Byte3 = 0x9D9,
    SyncAddress3Byte2 = 0x9DA,
    SyncAddress3Byte1 = 0x9DB,
    SyncAddress3Byte0 = 0x9DC,

}